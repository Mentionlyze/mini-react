/******/ (() => { // webpackBootstrap
var __webpack_exports__ = {};
/*!*********************!*\
  !*** ./src/main.js ***!
  \*********************/
function createElement(type, props, ...children) {
  return {
    type,
    props: { ...props,
      children: children.map(child => typeof child === 'object' ? child : createTextElement(child))
    }
  };
}

function createTextElement(text) {
  return {
    type: 'TEXT_ELEMENT',
    props: {
      nodeValue: text,
      children: []
    }
  };
}

function createDom(fiber) {
  const dom = fiber.type === 'TEXT_ELEMENT' ? document.createTextNode('') : document.createElement(fiber.type);
  updateDom(dom, {}, fiber.props);
  return dom;
}

const isEvent = key => key.startsWith('on');

const isProperty = key => key !== 'children' && !isEvent(key);

const isGone = (prev, next) => key => !(key in next);

const isNew = (prev, next) => key => prev[key] !== next[key];

function updateDom(dom, prevProps, nextProps) {
  console.log(dom); // remove event

  Object.keys(prevProps).filter(isEvent).filter(key => !(key in nextProps) || isNew(prevProps, nextProps)(key)).forEach(name => {
    const eventType = name.toLowerCase().substring(2);
    dom.removeEventListner(eventType, prevProps[name]);
  }); // remove old props

  Object.keys(prevProps).filter(isProperty).filter(isGone).forEach(name => dom[name] = ''); // set new Props

  Object.keys(nextProps).filter(isProperty).filter(isNew).forEach(name => dom[name] = nextProps[name]); // add new event listner

  Object.keys(nextProps).filter(isEvent).filter(key => !(key in nextProps) || isNew(prevProps, nextProps)(key)).forEach(name => {
    const eventType = name.toLowerCase().substring(2);
    dom.addEventListner(eventType, nextProps[name]);
  });
}

function commitRoot() {
  deletions.forEach(commitWork);
  commitWork(wipRoot.child);
  currentRoot = wipRoot;
  wipRoot = null;
}

function commitWork(fiber) {
  if (!fiber) {
    return;
  }

  let domParentFiber = fiber.parent;

  while (!domParentFiber.dom) {
    domParentFiber = domParentFiber.parent;
  }

  const domParent = domParentFiber.dom;

  if (fiber.effectTag === 'PLACEMENT' && !!fiber.dom) {
    domParent.appendChild(fiber.dom);
  } else if (fiber.effectTag === 'UPDATE' && !!fiber.dom) {
    updateDom(fiber.dom, fiber.alternate.props, fiber.props);
  } else if (fiber.effectTag === 'DELETION') {
    commitDeletion(fiber.dom, domParent);
  }

  commitWork(fiber.child);
  commitWork(fiber.sibling);
}

function commitDeletion(fiber, domParent) {
  if (fiber.dom) {
    domParent.removeChild(fiber.dom);
  } else {
    commitDeletion(fiber.child, domParent);
  }
}

let wipRoot = null;
let currentRoot = null;
let nextUnitOfWork = null;
let deletions = null;

function render(element, container) {
  wipRoot = {
    dom: container,
    props: {
      children: [element]
    },
    alternate: currentRoot
  };
  deletions = [];
  nextUnitOfWork = wipRoot;
}

function workLoop(deadline) {
  let shouldYield = false;

  while (nextUnitOfWork && !shouldYield) {
    nextUnitOfWork = performUnitOfWork(nextUnitOfWork);
    shouldYield = deadline.timeRemaining() < 1;
  }

  if (!nextUnitOfWork && wipRoot) {
    commitRoot();
  }

  requestIdleCallback(workLoop);
}

requestIdleCallback(workLoop);

function performUnitOfWork(fiber) {
  const isFunctionComponent = fiber.type instanceof Function;

  if (isFunctionComponent) {
    updateFunctionComponent(fiber);
  } else {
    updateHostComponent(fiber);
  }

  if (fiber.child) {
    return fiber.child;
  }

  let nextFiber = fiber;

  while (nextFiber) {
    if (nextFiber.sibling) {
      return nextFiber.sibling;
    }

    nextFiber = nextFiber.parent;
  }
}

let wipFiber = null;
let hookIndex = null;

function updateFunctionComponent(fiber) {
  wipFiber = fiber;
  hookIndex = 0;
  wipFiber.hooks = [];
  const children = [fiber.type(fiber.props)];
  reconcileChildren(fiber, children);
}

function useState(initial) {
  const oldHook = wipFiber.alternate && wipFiber.alternate.hooks[hookIndex];
  const hook = {
    state: oldHook ? oldHook.state : initial,
    queue: []
  };
  const actions = oldHook && oldHook.queue || [];
  actions.forEach(action => {
    hook.state = action(hook.state);
  });

  const setState = action => {
    hook.queue.push(action);
    wipRoot = {
      dom: currentRoot.dom,
      props: currentRoot.props,
      alternate: currentRoot
    };
    deletions = [];
    nextUnitOfWork = wipRoot;
  };

  wipFiber.hooks.push(hook);
  hookIndex++;
  return [hook.state, setState];
}

function updateHostComponent(fiber) {
  if (!fiber.dom) {
    fiber.dom = createDom(fiber);
  }

  reconcileChildren(fiber, fiber.props.children);
}

function reconcileChildren(wipFiber, elements) {
  let index = 0;
  const oldFiber = wipFiber.alternate && wipFiber.alternate.child;
  let prevSibling = null;

  while (index < elements.length || !!oldFiber) {
    const element = elements[index];
    let newFiber = null;
    const sameType = oldFiber && element && element.type === oldFiber.type; // update fiber

    if (sameType) {
      newFiber = {
        type: oldFiber.type,
        dom: oldFiber.dom,
        props: element.props,
        parent: wipFiber,
        alternate: oldFiber,
        effectTag: 'UPDATE'
      };
    } // add fiber


    if (element && !sameType) {
      newFiber = {
        type: element.type,
        dom: null,
        props: element.props,
        parent: wipFiber,
        alternate: null,
        effectTag: 'PLACEMENT'
      };
    } // remove fiber


    if (oldFiber && !sameType) {
      oldFiber.effectTag = 'DELETION';
      deletions.push(oldFiber);
    }

    if (index === 0) {
      wipFiber.child = newFiber;
    } else if (element) {
      prevSibling.sibling = newFiber;
    }

    prevSibling = newFiber;
    index++;
  }
}

const MReact = {
  createElement,
  render,
  useState
};
/**@jsx MReact.createElement */

function App() {
  const [state, setState] = MReact.useState(1);
  return MReact.createElement("div", {
    onClick: () => setState(c => c + 1)
  }, MReact.createElement("a", null, "Count: ", state));
}

const element = MReact.createElement(App, null);
const container = document.querySelector('#root');
MReact.render(element, container);
/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UUFBUSxDQUFDN0QsS0FBVCxHQUFpQmdGLFFBQWpCO0FBQ0QsS0FGRCxNQUVPLElBQUloQyxPQUFKLEVBQWE7QUFDbEI4QixNQUFBQSxXQUFXLENBQUNsQyxPQUFaLEdBQXNCb0MsUUFBdEI7QUFDRDs7QUFFREYsSUFBQUEsV0FBVyxHQUFHRSxRQUFkO0FBQ0FKLElBQUFBLEtBQUs7QUFDTjtBQUNGOztBQUVELE1BQU1NLE1BQU0sR0FBRztBQUNidkYsRUFBQUEsYUFEYTtBQUVib0QsRUFBQUEsTUFGYTtBQUdia0IsRUFBQUE7QUFIYSxDQUFmO0FBTUE7O0FBQ0EsU0FBU2tCLEdBQVQsR0FBZTtBQUNiLFFBQU0sQ0FBQ2QsS0FBRCxFQUFRSSxRQUFSLElBQW9CUyxNQUFNLENBQUNqQixRQUFQLENBQWdCLENBQWhCLENBQTFCO0FBQ0EsU0FDRTtBQUFLLFdBQU8sRUFBRSxNQUFNUSxRQUFRLENBQUVXLENBQUQsSUFBT0EsQ0FBQyxHQUFHLENBQVo7QUFBNUIsS0FDRSwyQ0FBV2YsS0FBWCxDQURGLENBREY7QUFLRDs7QUFDRCxNQUFNckIsT0FBTyxHQUFHLHFCQUFDLEdBQUQsT0FBaEI7QUFFQSxNQUFNQyxTQUFTLEdBQUcxQyxRQUFRLENBQUM4RSxhQUFULENBQXVCLE9BQXZCLENBQWxCO0FBQ0FILE1BQU0sQ0FBQ25DLE1BQVAsQ0FBY0MsT0FBZCxFQUF1QkMsU0FBdkIsRSIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9tYWluLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIGNyZWF0ZUVsZW1lbnQodHlwZSwgcHJvcHMsIC4uLmNoaWxkcmVuKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHR5cGUsXHJcbiAgICBwcm9wczoge1xyXG4gICAgICAuLi5wcm9wcyxcclxuICAgICAgY2hpbGRyZW46IGNoaWxkcmVuLm1hcCgoY2hpbGQpID0+XHJcbiAgICAgICAgdHlwZW9mIGNoaWxkID09PSAnb2JqZWN0JyA/IGNoaWxkIDogY3JlYXRlVGV4dEVsZW1lbnQoY2hpbGQpXHJcbiAgICAgICksXHJcbiAgICB9LFxyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlVGV4dEVsZW1lbnQodGV4dCkge1xyXG4gIHJldHVybiB7XHJcbiAgICB0eXBlOiAnVEVYVF9FTEVNRU5UJyxcclxuICAgIHByb3BzOiB7XHJcbiAgICAgIG5vZGVWYWx1ZTogdGV4dCxcclxuICAgICAgY2hpbGRyZW46IFtdLFxyXG4gICAgfSxcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZURvbShmaWJlcikge1xyXG4gIGNvbnN0IGRvbSA9XHJcbiAgICBmaWJlci50eXBlID09PSAnVEVYVF9FTEVNRU5UJ1xyXG4gICAgICA/IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCcnKVxyXG4gICAgICA6IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZmliZXIudHlwZSlcclxuXHJcbiAgdXBkYXRlRG9tKGRvbSwge30sIGZpYmVyLnByb3BzKVxyXG5cclxuICByZXR1cm4gZG9tXHJcbn1cclxuXHJcbmNvbnN0IGlzRXZlbnQgPSAoa2V5KSA9PiBrZXkuc3RhcnRzV2l0aCgnb24nKVxyXG5jb25zdCBpc1Byb3BlcnR5ID0gKGtleSkgPT4ga2V5ICE9PSAnY2hpbGRyZW4nICYmICFpc0V2ZW50KGtleSlcclxuY29uc3QgaXNHb25lID0gKHByZXYsIG5leHQpID0+IChrZXkpID0+ICEoa2V5IGluIG5leHQpXHJcbmNvbnN0IGlzTmV3ID0gKHByZXYsIG5leHQpID0+IChrZXkpID0+IHByZXZba2V5XSAhPT0gbmV4dFtrZXldXHJcblxyXG5mdW5jdGlvbiB1cGRhdGVEb20oZG9tLCBwcmV2UHJvcHMsIG5leHRQcm9wcykge1xyXG4gIGNvbnNvbGUubG9nKGRvbSlcclxuICAvLyByZW1vdmUgZXZlbnRcclxuICBPYmplY3Qua2V5cyhwcmV2UHJvcHMpXHJcbiAgICAuZmlsdGVyKGlzRXZlbnQpXHJcbiAgICAuZmlsdGVyKChrZXkpID0+ICEoa2V5IGluIG5leHRQcm9wcykgfHwgaXNOZXcocHJldlByb3BzLCBuZXh0UHJvcHMpKGtleSkpXHJcbiAgICAuZm9yRWFjaCgobmFtZSkgPT4ge1xyXG4gICAgICBjb25zdCBldmVudFR5cGUgPSBuYW1lLnRvTG93ZXJDYXNlKCkuc3Vic3RyaW5nKDIpXHJcbiAgICAgIGRvbS5yZW1vdmVFdmVudExpc3RuZXIoZXZlbnRUeXBlLCBwcmV2UHJvcHNbbmFtZV0pXHJcbiAgICB9KVxyXG5cclxuICAvLyByZW1vdmUgb2xkIHByb3BzXHJcbiAgT2JqZWN0LmtleXMocHJldlByb3BzKVxyXG4gICAgLmZpbHRlcihpc1Byb3BlcnR5KVxyXG4gICAgLmZpbHRlcihpc0dvbmUpXHJcbiAgICAuZm9yRWFjaCgobmFtZSkgPT4gKGRvbVtuYW1lXSA9ICcnKSlcclxuXHJcbiAgLy8gc2V0IG5ldyBQcm9wc1xyXG4gIE9iamVjdC5rZXlzKG5leHRQcm9wcylcclxuICAgIC5maWx0ZXIoaXNQcm9wZXJ0eSlcclxuICAgIC5maWx0ZXIoaXNOZXcpXHJcbiAgICAuZm9yRWFjaCgobmFtZSkgPT4gKGRvbVtuYW1lXSA9IG5leHRQcm9wc1tuYW1lXSkpXHJcblxyXG4gIC8vIGFkZCBuZXcgZXZlbnQgbGlzdG5lclxyXG4gIE9iamVjdC5rZXlzKG5leHRQcm9wcylcclxuICAgIC5maWx0ZXIoaXNFdmVudClcclxuICAgIC5maWx0ZXIoKGtleSkgPT4gIShrZXkgaW4gbmV4dFByb3BzKSB8fCBpc05ldyhwcmV2UHJvcHMsIG5leHRQcm9wcykoa2V5KSlcclxuICAgIC5mb3JFYWNoKChuYW1lKSA9PiB7XHJcbiAgICAgIGNvbnN0IGV2ZW50VHlwZSA9IG5hbWUudG9Mb3dlckNhc2UoKS5zdWJzdHJpbmcoMilcclxuICAgICAgZG9tLmFkZEV2ZW50TGlzdG5lcihldmVudFR5cGUsIG5leHRQcm9wc1tuYW1lXSlcclxuICAgIH0pXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNvbW1pdFJvb3QoKSB7XHJcbiAgZGVsZXRpb25zLmZvckVhY2goY29tbWl0V29yaylcclxuICBjb21taXRXb3JrKHdpcFJvb3QuY2hpbGQpXHJcbiAgY3VycmVudFJvb3QgPSB3aXBSb290XHJcbiAgd2lwUm9vdCA9IG51bGxcclxufVxyXG5cclxuZnVuY3Rpb24gY29tbWl0V29yayhmaWJlcikge1xyXG4gIGlmICghZmliZXIpIHtcclxuICAgIHJldHVyblxyXG4gIH1cclxuXHJcbiAgbGV0IGRvbVBhcmVudEZpYmVyID0gZmliZXIucGFyZW50XHJcbiAgd2hpbGUgKCFkb21QYXJlbnRGaWJlci5kb20pIHtcclxuICAgIGRvbVBhcmVudEZpYmVyID0gZG9tUGFyZW50RmliZXIucGFyZW50XHJcbiAgfVxyXG4gIGNvbnN0IGRvbVBhcmVudCA9IGRvbVBhcmVudEZpYmVyLmRvbVxyXG5cclxuICBpZiAoZmliZXIuZWZmZWN0VGFnID09PSAnUExBQ0VNRU5UJyAmJiAhIWZpYmVyLmRvbSkge1xyXG4gICAgZG9tUGFyZW50LmFwcGVuZENoaWxkKGZpYmVyLmRvbSlcclxuICB9IGVsc2UgaWYgKGZpYmVyLmVmZmVjdFRhZyA9PT0gJ1VQREFURScgJiYgISFmaWJlci5kb20pIHtcclxuICAgIHVwZGF0ZURvbShmaWJlci5kb20sIGZpYmVyLmFsdGVybmF0ZS5wcm9wcywgZmliZXIucHJvcHMpXHJcbiAgfSBlbHNlIGlmIChmaWJlci5lZmZlY3RUYWcgPT09ICdERUxFVElPTicpIHtcclxuICAgIGNvbW1pdERlbGV0aW9uKGZpYmVyLmRvbSwgZG9tUGFyZW50KVxyXG4gIH1cclxuXHJcbiAgY29tbWl0V29yayhmaWJlci5jaGlsZClcclxuICBjb21taXRXb3JrKGZpYmVyLnNpYmxpbmcpXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNvbW1pdERlbGV0aW9uKGZpYmVyLCBkb21QYXJlbnQpIHtcclxuICBpZiAoZmliZXIuZG9tKSB7XHJcbiAgICBkb21QYXJlbnQucmVtb3ZlQ2hpbGQoZmliZXIuZG9tKVxyXG4gIH0gZWxzZSB7XHJcbiAgICBjb21taXREZWxldGlvbihmaWJlci5jaGlsZCwgZG9tUGFyZW50KVxyXG4gIH1cclxufVxyXG5cclxubGV0IHdpcFJvb3QgPSBudWxsXHJcbmxldCBjdXJyZW50Um9vdCA9IG51bGxcclxubGV0IG5leHRVbml0T2ZXb3JrID0gbnVsbFxyXG5sZXQgZGVsZXRpb25zID0gbnVsbFxyXG5cclxuZnVuY3Rpb24gcmVuZGVyKGVsZW1lbnQsIGNvbnRhaW5lcikge1xyXG4gIHdpcFJvb3QgPSB7XHJcbiAgICBkb206IGNvbnRhaW5lcixcclxuICAgIHByb3BzOiB7XHJcbiAgICAgIGNoaWxkcmVuOiBbZWxlbWVudF0sXHJcbiAgICB9LFxyXG4gICAgYWx0ZXJuYXRlOiBjdXJyZW50Um9vdCxcclxuICB9XHJcbiAgZGVsZXRpb25zID0gW11cclxuICBuZXh0VW5pdE9mV29yayA9IHdpcFJvb3RcclxufVxyXG5cclxuZnVuY3Rpb24gd29ya0xvb3AoZGVhZGxpbmUpIHtcclxuICBsZXQgc2hvdWxkWWllbGQgPSBmYWxzZVxyXG4gIHdoaWxlIChuZXh0VW5pdE9mV29yayAmJiAhc2hvdWxkWWllbGQpIHtcclxuICAgIG5leHRVbml0T2ZXb3JrID0gcGVyZm9ybVVuaXRPZldvcmsobmV4dFVuaXRPZldvcmspXHJcbiAgICBzaG91bGRZaWVsZCA9IGRlYWRsaW5lLnRpbWVSZW1haW5pbmcoKSA8IDFcclxuICB9XHJcblxyXG4gIGlmICghbmV4dFVuaXRPZldvcmsgJiYgd2lwUm9vdCkge1xyXG4gICAgY29tbWl0Um9vdCgpXHJcbiAgfVxyXG5cclxuICByZXF1ZXN0SWRsZUNhbGxiYWNrKHdvcmtMb29wKVxyXG59XHJcblxyXG5yZXF1ZXN0SWRsZUNhbGxiYWNrKHdvcmtMb29wKVxyXG5cclxuZnVuY3Rpb24gcGVyZm9ybVVuaXRPZldvcmsoZmliZXIpIHtcclxuICBjb25zdCBpc0Z1bmN0aW9uQ29tcG9uZW50ID0gZmliZXIudHlwZSBpbnN0YW5jZW9mIEZ1bmN0aW9uXHJcbiAgaWYgKGlzRnVuY3Rpb25Db21wb25lbnQpIHtcclxuICAgIHVwZGF0ZUZ1bmN0aW9uQ29tcG9uZW50KGZpYmVyKVxyXG4gIH0gZWxzZSB7XHJcbiAgICB1cGRhdGVIb3N0Q29tcG9uZW50KGZpYmVyKVxyXG4gIH1cclxuXHJcbiAgaWYgKGZpYmVyLmNoaWxkKSB7XHJcbiAgICByZXR1cm4gZmliZXIuY2hpbGRcclxuICB9XHJcblxyXG4gIGxldCBuZXh0RmliZXIgPSBmaWJlclxyXG4gIHdoaWxlIChuZXh0RmliZXIpIHtcclxuICAgIGlmIChuZXh0RmliZXIuc2libGluZykge1xyXG4gICAgICByZXR1cm4gbmV4dEZpYmVyLnNpYmxpbmdcclxuICAgIH1cclxuICAgIG5leHRGaWJlciA9IG5leHRGaWJlci5wYXJlbnRcclxuICB9XHJcbn1cclxuXHJcbmxldCB3aXBGaWJlciA9IG51bGxcclxubGV0IGhvb2tJbmRleCA9IG51bGxcclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZUZ1bmN0aW9uQ29tcG9uZW50KGZpYmVyKSB7XHJcbiAgd2lwRmliZXIgPSBmaWJlclxyXG4gIGhvb2tJbmRleCA9IDBcclxuICB3aXBGaWJlci5ob29rcyA9IFtdXHJcbiAgY29uc3QgY2hpbGRyZW4gPSBbZmliZXIudHlwZShmaWJlci5wcm9wcyldXHJcbiAgcmVjb25jaWxlQ2hpbGRyZW4oZmliZXIsIGNoaWxkcmVuKVxyXG59XHJcblxyXG5mdW5jdGlvbiB1c2VTdGF0ZShpbml0aWFsKSB7XHJcbiAgY29uc3Qgb2xkSG9vayA9IHdpcEZpYmVyLmFsdGVybmF0ZSAmJiB3aXBGaWJlci5hbHRlcm5hdGUuaG9va3NbaG9va0luZGV4XVxyXG5cclxuICBjb25zdCBob29rID0ge1xyXG4gICAgc3RhdGU6IG9sZEhvb2sgPyBvbGRIb29rLnN0YXRlIDogaW5pdGlhbCxcclxuICAgIHF1ZXVlOiBbXSxcclxuICB9XHJcblxyXG4gIGNvbnN0IGFjdGlvbnMgPSAob2xkSG9vayAmJiBvbGRIb29rLnF1ZXVlKSB8fCBbXVxyXG4gIGFjdGlvbnMuZm9yRWFjaCgoYWN0aW9uKSA9PiB7XHJcbiAgICBob29rLnN0YXRlID0gYWN0aW9uKGhvb2suc3RhdGUpXHJcbiAgfSlcclxuXHJcbiAgY29uc3Qgc2V0U3RhdGUgPSAoYWN0aW9uKSA9PiB7XHJcbiAgICBob29rLnF1ZXVlLnB1c2goYWN0aW9uKVxyXG4gICAgd2lwUm9vdCA9IHtcclxuICAgICAgZG9tOiBjdXJyZW50Um9vdC5kb20sXHJcbiAgICAgIHByb3BzOiBjdXJyZW50Um9vdC5wcm9wcyxcclxuICAgICAgYWx0ZXJuYXRlOiBjdXJyZW50Um9vdCxcclxuICAgIH1cclxuICAgIGRlbGV0aW9ucyA9IFtdXHJcbiAgICBuZXh0VW5pdE9mV29yayA9IHdpcFJvb3RcclxuICB9XHJcblxyXG4gIHdpcEZpYmVyLmhvb2tzLnB1c2goaG9vaylcclxuICBob29rSW5kZXgrK1xyXG5cclxuICByZXR1cm4gW2hvb2suc3RhdGUsIHNldFN0YXRlXVxyXG59XHJcblxyXG5mdW5jdGlvbiB1cGRhdGVIb3N0Q29tcG9uZW50KGZpYmVyKSB7XHJcbiAgaWYgKCFmaWJlci5kb20pIHtcclxuICAgIGZpYmVyLmRvbSA9IGNyZWF0ZURvbShmaWJlcilcclxuICB9XHJcbiAgcmVjb25jaWxlQ2hpbGRyZW4oZmliZXIsIGZpYmVyLnByb3BzLmNoaWxkcmVuKVxyXG59XHJcblxyXG5mdW5jdGlvbiByZWNvbmNpbGVDaGlsZHJlbih3aXBGaWJlciwgZWxlbWVudHMpIHtcclxuICBsZXQgaW5kZXggPSAwXHJcbiAgY29uc3Qgb2xkRmliZXIgPSB3aXBGaWJlci5hbHRlcm5hdGUgJiYgd2lwRmliZXIuYWx0ZXJuYXRlLmNoaWxkXHJcbiAgbGV0IHByZXZTaWJsaW5nID0gbnVsbFxyXG4gIHdoaWxlIChpbmRleCA8IGVsZW1lbnRzLmxlbmd0aCB8fCAhIW9sZEZpYmVyKSB7XHJcbiAgICBjb25zdCBlbGVtZW50ID0gZWxlbWVudHNbaW5kZXhdXHJcbiAgICBsZXQgbmV3RmliZXIgPSBudWxsXHJcbiAgICBjb25zdCBzYW1lVHlwZSA9IG9sZEZpYmVyICYmIGVsZW1lbnQgJiYgZWxlbWVudC50eXBlID09PSBvbGRGaWJlci50eXBlXHJcblxyXG4gICAgLy8gdXBkYXRlIGZpYmVyXHJcbiAgICBpZiAoc2FtZVR5cGUpIHtcclxuICAgICAgbmV3RmliZXIgPSB7XHJcbiAgICAgICAgdHlwZTogb2xkRmliZXIudHlwZSxcclxuICAgICAgICBkb206IG9sZEZpYmVyLmRvbSxcclxuICAgICAgICBwcm9wczogZWxlbWVudC5wcm9wcyxcclxuICAgICAgICBwYXJlbnQ6IHdpcEZpYmVyLFxyXG4gICAgICAgIGFsdGVybmF0ZTogb2xkRmliZXIsXHJcbiAgICAgICAgZWZmZWN0VGFnOiAnVVBEQVRFJyxcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIGFkZCBmaWJlclxyXG4gICAgaWYgKGVsZW1lbnQgJiYgIXNhbWVUeXBlKSB7XHJcbiAgICAgIG5ld0ZpYmVyID0ge1xyXG4gICAgICAgIHR5cGU6IGVsZW1lbnQudHlwZSxcclxuICAgICAgICBkb206IG51bGwsXHJcbiAgICAgICAgcHJvcHM6IGVsZW1lbnQucHJvcHMsXHJcbiAgICAgICAgcGFyZW50OiB3aXBGaWJlcixcclxuICAgICAgICBhbHRlcm5hdGU6IG51bGwsXHJcbiAgICAgICAgZWZmZWN0VGFnOiAnUExBQ0VNRU5UJyxcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIHJlbW92ZSBmaWJlclxyXG4gICAgaWYgKG9sZEZpYmVyICYmICFzYW1lVHlwZSkge1xyXG4gICAgICBvbGRGaWJlci5lZmZlY3RUYWcgPSAnREVMRVRJT04nXHJcbiAgICAgIGRlbGV0aW9ucy5wdXNoKG9sZEZpYmVyKVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChpbmRleCA9PT0gMCkge1xyXG4gICAgICB3aXBGaWJlci5jaGlsZCA9IG5ld0ZpYmVyXHJcbiAgICB9IGVsc2UgaWYgKGVsZW1lbnQpIHtcclxuICAgICAgcHJldlNpYmxpbmcuc2libGluZyA9IG5ld0ZpYmVyXHJcbiAgICB9XHJcblxyXG4gICAgcHJldlNpYmxpbmcgPSBuZXdGaWJlclxyXG4gICAgaW5kZXgrK1xyXG4gIH1cclxufVxyXG5cclxuY29uc3QgTVJlYWN0ID0ge1xyXG4gIGNyZWF0ZUVsZW1lbnQsXHJcbiAgcmVuZGVyLFxyXG4gIHVzZVN0YXRlLFxyXG59XHJcblxyXG4vKipAanN4IE1SZWFjdC5jcmVhdGVFbGVtZW50ICovXHJcbmZ1bmN0aW9uIEFwcCgpIHtcclxuICBjb25zdCBbc3RhdGUsIHNldFN0YXRlXSA9IE1SZWFjdC51c2VTdGF0ZSgxKVxyXG4gIHJldHVybiAoXHJcbiAgICA8ZGl2IG9uQ2xpY2s9eygpID0+IHNldFN0YXRlKChjKSA9PiBjICsgMSl9PlxyXG4gICAgICA8YT5Db3VudDoge3N0YXRlfTwvYT5cclxuICAgIDwvZGl2PlxyXG4gIClcclxufVxyXG5jb25zdCBlbGVtZW50ID0gPEFwcCAvPlxyXG5cclxuY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Jvb3QnKVxyXG5NUmVhY3QucmVuZGVyKGVsZW1lbnQsIGNvbnRhaW5lcilcclxuIl0sIm5hbWVzIjpbImNyZWF0ZUVsZW1lbnQiLCJ0eXBlIiwicHJvcHMiLCJjaGlsZHJlbiIsIm1hcCIsImNoaWxkIiwiY3JlYXRlVGV4dEVsZW1lbnQiLCJ0ZXh0Iiwibm9kZVZhbHVlIiwiY3JlYXRlRG9tIiwiZmliZXIiLCJkb20iLCJkb2N1bWVudCIsImNyZWF0ZVRleHROb2RlIiwidXBkYXRlRG9tIiwiaXNFdmVudCIsImtleSIsInN0YXJ0c1dpdGgiLCJpc1Byb3BlcnR5IiwiaXNHb25lIiwicHJldiIsIm5leHQiLCJpc05ldyIsInByZXZQcm9wcyIsIm5leHRQcm9wcyIsImNvbnNvbGUiLCJsb2ciLCJPYmplY3QiLCJrZXlzIiwiZmlsdGVyIiwiZm9yRWFjaCIsIm5hbWUiLCJldmVudFR5cGUiLCJ0b0xvd2VyQ2FzZSIsInN1YnN0cmluZyIsInJlbW92ZUV2ZW50TGlzdG5lciIsImFkZEV2ZW50TGlzdG5lciIsImNvbW1pdFJvb3QiLCJkZWxldGlvbnMiLCJjb21taXRXb3JrIiwid2lwUm9vdCIsImN1cnJlbnRSb290IiwiZG9tUGFyZW50RmliZXIiLCJwYXJlbnQiLCJkb21QYXJlbnQiLCJlZmZlY3RUYWciLCJhcHBlbmRDaGlsZCIsImFsdGVybmF0ZSIsImNvbW1pdERlbGV0aW9uIiwic2libGluZyIsInJlbW92ZUNoaWxkIiwibmV4dFVuaXRPZldvcmsiLCJyZW5kZXIiLCJlbGVtZW50IiwiY29udGFpbmVyIiwid29ya0xvb3AiLCJkZWFkbGluZSIsInNob3VsZFlpZWxkIiwicGVyZm9ybVVuaXRPZldvcmsiLCJ0aW1lUmVtYWluaW5nIiwicmVxdWVzdElkbGVDYWxsYmFjayIsImlzRnVuY3Rpb25Db21wb25lbnQiLCJGdW5jdGlvbiIsInVwZGF0ZUZ1bmN0aW9uQ29tcG9uZW50IiwidXBkYXRlSG9zdENvbXBvbmVudCIsIm5leHRGaWJlciIsIndpcEZpYmVyIiwiaG9va0luZGV4IiwiaG9va3MiLCJyZWNvbmNpbGVDaGlsZHJlbiIsInVzZVN0YXRlIiwiaW5pdGlhbCIsIm9sZEhvb2siLCJob29rIiwic3RhdGUiLCJxdWV1ZSIsImFjdGlvbnMiLCJhY3Rpb24iLCJzZXRTdGF0ZSIsInB1c2giLCJlbGVtZW50cyIsImluZGV4Iiwib2xkRmliZXIiLCJwcmV2U2libGluZyIsImxlbmd0aCIsIm5ld0ZpYmVyIiwic2FtZVR5cGUiLCJNUmVhY3QiLCJBcHAiLCJjIiwicXVlcnlTZWxlY3RvciJdLCJzb3VyY2VSb290IjoiIn0=